import { defineStore } from 'pinia';
import { ref } from 'vue';

export const useCurrentMessageStore = defineStore('CurrentMessageStore', () => {
    // CurrentMessage 是一个 Map 类型
    const currentMessages = ref(new Map());

    function setCurrentMessage(name: string, time: number, msg: string) {
        currentMessages.value.set(name, { time, msg });
        setTimeout(() => {
            currentMessages.value.delete(name);
        }, 10000); // 10秒后清除消息
    }

    // 获取用户的当前消息
    function getCurrentMessage(name) {
        return currentMessages.value.get(name);
    }

    // 删除用户的当前消息
    function deleteCurrentMessage(name) {
        currentMessages.value.delete(name);
    }

    return {
        currentMessages,
        setCurrentMessage,
        getCurrentMessage,
        deleteCurrentMessage,
    };
});
